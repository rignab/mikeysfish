<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mikey's Fish - Your Order</title>
    <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
    <header style="padding: 8px 0;">
        <div class="container" style="text-align: center;">
            <h1 style="font-size: 1.8rem; margin: 0;">Mikey's Fish</h1>
            <p style="margin: 4px 0 0 0; font-size: 1.1rem;">Fresh seafood 7 days a week!</p>
        </div>
    </header>

    <nav style="padding: 6px 0;">
        <div class="container">
            <a href="index.html" style="padding: 8px 12px; font-size: 0.9rem;">Home</a>
            <a href="catalog.html" style="padding: 8px 12px; font-size: 0.9rem;">Catalog</a>
            <a href="booking.html" style="padding: 8px 12px; font-size: 0.9rem;">Bookings</a>
            <a href="order.html" class="active" style="padding: 8px 12px; font-size: 0.9rem;">Orders</a>
            <a href="about.html" style="padding: 8px 12px; font-size: 0.9rem;">About Us</a>
        </div>
    </nav>

    <main class="container">
        <div style="margin: 48px 0;">
            <h2 style="text-align: center; margin-bottom: 32px;">Your Order</h2>
            
            <div id="orderSummary">
                <!-- Order items will be displayed here -->
            </div>
            
            <div style="text-align: center; margin-top: 32px;">
                <a href="#" id="clearBtn" class="btn" style="text-decoration: none; background: #6b7280; margin-right: 16px;">Clear Order</a>
                <a href="catalog.html" class="btn" style="text-decoration: none; margin-right: 16px;">Continue Shopping</a>
                <a href="index.html" class="btn" style="text-decoration: none; background: var(--gray-700);">Back to Home</a>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 Mikey's Fish. All rights reserved. | Fresh salmon since 1985</p>
            <p style="margin-top: 8px; font-size: 0.9rem;">
                üìç 8105 27th Ave NE, Tulalip, WA 98271 | üìû (360) 403-5252 | üïí Open 7 days a week
            </p>
        </div>
    </footer>

    <script src="assets/app.js"></script>
    <script>
        // Enhanced order rendering function
        function renderOrder() {
            const el = document.querySelector("#orderSummary");
            if (!el) return;
            
            const cart = getCart();
            if (cart.length === 0) {
                el.innerHTML = `
                    <div class="card" style="text-align: center; padding: 40px;">
                        <div style="font-size: 4rem; margin-bottom: 16px;">üõí</div>
                        <h3>Your order is empty</h3>
                        <p style="color: var(--gray-700); margin-bottom: 24px;">Browse our catalog to add some delicious salmon to your order!</p>
                        <a href="catalog.html" class="btn" style="text-decoration: none;">Browse Catalog</a>
                    </div>
                `;
                return;
            }

            // Calculate total
            const grandTotal = cart.reduce((sum, item) => {
                const itemTotal = (item.price || 0) * (item.qty || 0);
                return sum + itemTotal;
            }, 0);

            el.innerHTML = `
                <div class="card">
                    <h3 style="color: var(--blue); margin-bottom: 24px;">Order Summary</h3>
                    
                    <div style="margin-bottom: 24px;">
                        ${cart.map(item => {
                            // Check if this is a smoked salmon product
                            const isSmoked = item.sku && (
                                item.sku.includes('sweet-cured') || 
                                item.sku.includes('regular-cured')
                            );
                            const unit = isSmoked ? 'unit' : 'lb';
                            const unitPlural = isSmoked ? 'units' : 'lbs';
                            
                            return `
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid var(--gray-200);">
                                    <div>
                                        <h4 style="margin: 0 0 4px 0; color: var(--blue);">${item.name || item.sku}</h4>
                                        <p style="margin: 0; color: var(--gray-700); font-size: 0.9rem;">$${(item.price || 0).toFixed(2)} per ${unit}</p>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-weight: bold; margin-bottom: 4px;">${(item.qty || 0).toFixed(1)} ${unitPlural}</div>
                                        <div style="color: var(--blue); font-weight: bold;">$${((item.price || 0) * (item.qty || 0)).toFixed(2)}</div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    
                    <div style="border-top: 2px solid var(--blue); padding-top: 16px; margin-bottom: 24px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; font-size: 1.2rem; font-weight: bold;">
                            <span>Total:</span>
                            <span style="color: var(--blue);">$${grandTotal.toFixed(2)}</span>
                        </div>
                    </div>
                    
                </div>
            `;
            
            // Add event listeners
            document.querySelector("#clearBtn")?.addEventListener("click", () => {
                if (confirm("Are you sure you want to clear your entire order?")) {
                    setCart([]);
                    renderOrder();
                }
            });
            
        }

        // Render order when page loads
        renderOrder();
    </script>
</body>
</html>
